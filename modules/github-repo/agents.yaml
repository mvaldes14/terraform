# GitHub Repository Automation Agents Configuration
# This file defines automation agents for managing GitHub repositories

agents:
  # Repository Scaffolding Agent
  - name: repo-scaffolder
    description: "Automates the creation of new repositories with standard configurations"
    triggers:
      - type: manual
      - type: scheduled
        cron: "0 0 * * 0"  # Weekly on Sunday
    actions:
      - validate_repo_name
      - check_duplicate
      - create_repository
      - initialize_readme
      - setup_branch_protection
      - configure_webhooks
    settings:
      default_visibility: public
      default_license: MIT
      enable_issues: true
      enable_vulnerability_alerts: true

  # Secret Management Agent
  - name: secret-manager
    description: "Manages GitHub Actions secrets across repositories"
    triggers:
      - type: manual
      - type: secret_rotation
        interval: 90d
    actions:
      - validate_secrets
      - rotate_expiring_secrets
      - sync_common_secrets
      - audit_secret_usage
    settings:
      common_secrets:
        - DOCKERHUB_TOKEN
        - DOCKERHUB_USERNAME
        - TELEGRAM_TOKEN
        - TELEGRAM_TO
      sensitive: true

  # Webhook Configuration Agent
  - name: webhook-configurator
    description: "Configures and maintains webhooks across repositories"
    triggers:
      - type: manual
      - type: webhook_change
    actions:
      - validate_webhook_url
      - test_webhook_connectivity
      - configure_webhook
      - verify_webhook_events
    settings:
      default_events:
        - push
        - pull_request
        - issues
        - release
      content_type: json
      active: true

  # Branch Protection Agent
  - name: branch-protector
    description: "Ensures branch protection rules are applied consistently"
    triggers:
      - type: manual
      - type: repo_created
      - type: scheduled
        cron: "0 2 * * *"  # Daily at 2 AM
    actions:
      - scan_repositories
      - check_protection_rules
      - apply_missing_protections
      - report_violations
    settings:
      protected_branches:
        - main
        - master
      required_reviews: 1
      dismiss_stale_reviews: true
      enforce_admins: false

  # Repository Compliance Agent
  - name: compliance-checker
    description: "Ensures repositories meet organizational compliance standards"
    triggers:
      - type: scheduled
        cron: "0 9 * * 1"  # Weekly on Monday at 9 AM
      - type: repo_modified
    actions:
      - check_license
      - verify_vulnerability_alerts
      - validate_topics
      - check_required_files
      - generate_compliance_report
    settings:
      required_files:
        - README.md
        - LICENSE
        - .gitignore
      required_topics_min: 1
      allowed_licenses:
        - MIT
        - Apache-2.0
        - GPL-3.0

  # Topic Management Agent
  - name: topic-manager
    description: "Manages and standardizes repository topics"
    triggers:
      - type: manual
      - type: scheduled
        cron: "0 10 * * 6"  # Weekly on Saturday at 10 AM
    actions:
      - scan_repository_content
      - suggest_topics
      - normalize_topics
      - update_topics
    settings:
      topic_categories:
        languages:
          - python
          - go
          - javascript
          - rust
        frameworks:
          - terraform
          - kubernetes
          - docker
        categories:
          - automation
          - homelab
          - neovim
          - security

  # Repository Cleanup Agent
  - name: repo-cleanup
    description: "Identifies and archives inactive repositories"
    triggers:
      - type: scheduled
        cron: "0 0 1 * *"  # Monthly on the 1st
    actions:
      - scan_activity
      - identify_inactive_repos
      - notify_owners
      - archive_confirmed
      - generate_cleanup_report
    settings:
      inactivity_threshold_days: 180
      archive_on_destroy: true
      notify_before_archive: true
      notification_period_days: 30

# Global Settings
global:
  terraform:
    module_path: "modules/github-repo"
    state_backend: "s3"
  notifications:
    enabled: true
    channels:
      - type: telegram
        priority: high
      - type: discord
        priority: medium
  logging:
    level: info
    retention_days: 90
  audit:
    enabled: true
    track_changes: true
